<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    <link rel="icon" href="https://github.githubassets.com/favicons/favicon.svg">
    <script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
    <meta name="description" content="博客标签页">
    <title>博客 - 标签</title>
    <style>
        body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 900px;
            margin: 20px auto;
            padding: 45px;
            font-size: 16px;
            font-family: sans-serif;
            line-height: 1.25;
        }
        #header {
            display: flex;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));
            margin-bottom: 16px;
        }
        #footer {
            margin-top: 64px;
            text-align: center;
            font-size: small;
        }
        .tagTitle {
            margin: auto 0;
            font-size: 40px;
            font-weight: bold;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        .title-right {
            display: flex;
            margin: auto 0 0 auto;
        }
        .subnav-search {
            width: 222px;
            margin-top: 8px;
            margin-right: 8px;
        }
        .subnav-search-input {
            width: 160px;
            border-top-right-radius: 0px;
            border-bottom-right-radius: 0px;
        }
        .subnav-search button {
            padding: 5px 8px;
            border-top-left-radius: 0px;
            border-bottom-left-radius: 0px;
        }
        .SideNav-icon {
            margin-right: 16px;
        }
        .Label {
            color: #fff;
            margin-left: 4px;
        }
        #taglabel .Label {
            margin-bottom: 8px;
        }
        .Counter {
            color: #fff;
            background-color: rgba(234, 238, 242, 0.5);
        }
        .genTime {
            float: right;
        }
        .d-flex {
            min-width: 0;
        }
        .listTitle {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        .listLabels {
            white-space: nowrap;
        }
        @media (max-width: 600px) {
            body {
                padding: 8px;
            }
            .tagTitle {
                display: none;
            }
            .LabelTime {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="header">
        <span class="tagTitle">加载中<span class="AnimatedEllipsis"></span></span>
        <div class="title-right">
            <div class="subnav-search">
                <input type="search" class="form-control subnav-search-input float-left" aria-label="搜索站点" value="" style="height:32px;">
                <button class="btn float-left" type="submit" onclick="javascript:searchShow()">搜索</button>
                <svg class="subnav-search-icon octicon octicon-search" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true">
                    <path id="searchSVG" fill-rule="evenodd"></path>
                </svg>
            </div>
            <a href="https://liumiao-yykx.github.io" id="buttonHome" class="btn btn-invisible circle" title="首页">
                <svg class="octicon" width="16" height="16">
                    <path id="pathHome" fill-rule="evenodd"></path>
                </svg>
            </a>
            <a class="btn btn-invisible circle" onclick="modeSwitch()" title="切换主题">
                <svg class="octicon" width="16" height="16">
                    <path id="themeSwitch" fill-rule="evenodd"></path>
                </svg>
            </a>
        </div>
    </div>
    <div id="content">
        <div id="taglabel" style="margin-bottom:8px;"></div>
        <nav class="SideNav"></nav>
        <div class="notFind" style="display:none;font-size:24px;margin:8px;">未找到</div>
    </div>
    <div id="footer">
        <div id="footer1">版权所有 © <span id="copyrightYear"></span> <a href="https://liumiao-yykx.github.io">博客</a></div>
        <div id="footer2">
            <span id="runday"></span><span>由 <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a> 提供支持</span>
        </div>
        <script>
            var now = new Date();
            document.getElementById("copyrightYear").innerHTML = now.getFullYear();
            if ("" != "") {
                var startSite = new Date("");
                var diff = now.getTime() - startSite.getTime();
                var diffDay = Math.floor(diff / (1000 * 60 * 60 * 24));
                document.getElementById("runday").innerHTML = "网站运行" + diffDay + "天" + " • ";
            }
        </script>
    </div>
    <script>
        var IconList = {
            'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 ...',
            'home': 'M10 2.5a.75.75 0 00-1.5 0v4.69l-3.22-3.22a.75.75 0 10-1.06 1.06L8 8.94l4.78-4.78a.75.75 0 00-1.06-1.06L10 2.5zm2.78 5.72l-3.22 3.22V10a.75.75 0 00-1.5 0v1.44l-3.22-3.22a.75.75 0 10-1.06 1.06L8 13.06l4.78-4.78a.75.75 0 00-1.06-1.06z',
            'search': 'M11.742 10.344a6.5 6.5 0 10-1.397 1.398l3.85 3.85a1 1 0 001.415-1.414l-3.868-3.868zm-5.742-.844a4.5 4.5 0 110-9 4.5 4.5 0 010 9z',
            'post': 'M4 13h8a1 1 0 001-1V4a1 1 0 00-1-1H4a1 1 0 00-1 1v8a1 1 0 001 1zm1-9h6v7H5V4z'
        };
        let themeSettings = {
            "dark": ["dark", "moon", "#00f0ff", "dark-blue"],
            "light": ["light", "sun", "#ff5000", "github-light"],
            "auto": ["auto", "sync", "", "preferred-color-scheme"]
        };
        function changeTheme(mode, icon, color, utheme) {
            document.documentElement.setAttribute("data-color-mode", mode);
            document.getElementById("themeSwitch").setAttribute("d", value = IconList[icon]);
            document.getElementById("themeSwitch").parentNode.style.color = color;
            if (utterancesLoad == 1) { utterancesTheme(utheme); }
        }
        function modeSwitch() {
            let currentMode = document.documentElement.getAttribute('data-color-mode');
            let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
            localStorage.setItem("meek_theme", newMode);
            if (themeSettings[newMode]) {
                changeTheme(...themeSettings[newMode]);
            }
        }
        function utterancesTheme(theme) {
            const message = { type: 'set-theme', theme: theme };
            const iframe = document.getElementsByClassName('utterances-frame')[0];
            iframe.contentWindow.postMessage(message, 'https://utteranc.es');
        }
        if (themeSettings[theme]) { changeTheme(...themeSettings[theme]); }
        console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n", "padding:5px 0;background:#02d81d;color:#fff");
    </script>
    <script>
        document.getElementById("pathHome").setAttribute("d", IconList["home"]);
        document.getElementById("searchSVG").setAttribute("d", IconList["search"]);
        tagList = [];
        labelsCount = {};
        jsonData = '';
        let requestJson = "postList.json"
        let request = new XMLHttpRequest();
        request.open("GET", requestJson);
        request.responseType = 'text';
        request.send();
        request.onload = function () {
            jsonData = JSON.parse(request.response);
            console.log(jsonData);
            showList(labelsCount);
            setClassDisplay(decodeURI(window.location.hash.slice(1)));
        }
        function showList(labelsCount) {
            let SideNav = document.getElementsByClassName("SideNav")[0];
            SideNav.classList.add("border");
            let taglabel = document.getElementById("taglabel");
            jsonData['labelColorDict']["All"] = "#000";
            labelsCount["All"] = 0;
            for (let key in jsonData) {
                if (key !== 'labelColorDict' && Array.isArray(jsonData[key]['labels'])) {
                    labelsCount["All"]++;
                    for (let label of jsonData[key]['labels']) {
                        labelsCount[label] = (labelsCount[label] || 0) + 1;
                    }
                }
            }
            let sortedLabelsList = Object.keys(labelsCount).sort((a, b) => labelsCount[b] - labelsCount[a]);
            for (let label of sortedLabelsList) {
                tagList.push(label);
                let showLabels = document.createElement("button");
                showLabels.setAttribute("class", "Label");
                showLabels.setAttribute("style", "background-color:" + jsonData['labelColorDict'][label] + ";padding:4px;");
                showLabels.innerHTML = "&nbsp;&nbsp;" + label + " ";
                showLabels.setAttribute("onclick", "javascript:updateShowTag('" + label + "');");
                let LabelNum = document.createElement("span");
                LabelNum.setAttribute("class", "Counter");
                LabelNum.innerHTML = labelsCount[label];
                showLabels.appendChild(LabelNum);
                taglabel.appendChild(showLabels);
            }
            for (i in jsonData) {
                if (i != 'labelColorDict') {
                    let div = document.createElement("div");
                    div.setAttribute("class", "lists " + jsonData[i]['labels'].join(" "));
                    let item = document.createElement("a");
                    item.setAttribute("class", "SideNav-item d-flex flex-items-center flex-justify-between");
                    item.setAttribute("href", jsonData[i]['postUrl']);
                    let center = document.createElement("div");
                    center.setAttribute("class", "d-flex flex-items-center");
                    svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    span = document.createElement("span");
                    svg.setAttributeNS(null, "class", "SideNav-icon octicon");
                    svg.setAttributeNS(null, "style", "width:16px;height:16px");
                    path.setAttributeNS(null, "d", IconList["post"]);
                    svg.appendChild(path);
                    let title = document.createElement("span");
                    title.setAttribute("class", "listTitle");
                    title.innerHTML = jsonData[i]['postTitle'];
                    center.appendChild(svg);
                    center.appendChild(title);
                    let listLabels = document.createElement("div");
                    listLabels.setAttribute("class", "listLabels");
                    for (label of jsonData[i]['labels']) {
                        let LabelName = document.createElement("span");
                        LabelName.setAttribute("class", "Label LabelName");
                        LabelName.setAttribute("style", "background-color:" + jsonData['labelColorDict'][label]);
                        LabelName.innerHTML = label;
                        listLabels.appendChild(LabelName);
                    }
                    let LabelTime = document.createElement("span");
                    LabelTime.setAttribute("class", "Label LabelTime");
                    LabelTime.setAttribute("style", "background-color:" + jsonData[i]['dateLabelColor']);
                    LabelTime.innerHTML = jsonData[i]['createdDate'];
                    listLabels.appendChild(LabelTime);
                    item.appendChild(center);
                    item.appendChild(listLabels);
                    div.appendChild(item);
                    SideNav.appendChild(div);
                }
            }
        }
        function updateShowTag(label) {
            if (window.location.hash.slice(1) != encodeURI(label)) {
                window.location.hash = "#" + (label);
                setClassDisplay(label);
            }
        }
        function setClassDisplay(label) {
            let lists = document.getElementsByClassName("lists");
            let tagTitle = document.getElementsByClassName("tagTitle")[0];
            tagTitle.innerHTML = "标签 #" + label;
            document.title = label + " - 博客";
            document.getElementsByClassName("subnav-search-input")[0].value = '';
            if (label == "All") {
                for (let i = 0; i < lists.length; i++) { lists[i].style.display = 'block'; }
                document.getElementsByClassName("notFind")[0].style.display = 'none';
            }
            else if (tagList.indexOf(label) != -1) {
                for (let i = 0; i < lists.length; i++) {
                    lists[i].style.display = 'none';
                }
                let labels = document.getElementsByClassName(label);
                for (let i = 0; i < labels.length; i++) {
                    labels[i].style.display = 'block';
                }
                document.getElementsByClassName("notFind")[0].style.display = 'none';
            }
            else {
                document.getElementsByClassName("subnav-search-input")[0].value = label;
                searchShow();
            }
        }
        function searchShow() {
            let lists = document.getElementsByClassName("lists");
            let tagTitle = document.getElementsByClassName("tagTitle")[0];
            let searchInput = document.getElementsByClassName("subnav-search-input")[0].value;
            tagTitle.innerHTML = "搜索 #" + searchInput;
            if (searchInput == '') { document.title = "搜索 - 博客"; }
            else { document.title = searchInput + " - 博客"; }
            let a = 0;
            window.location.hash = "#" + (searchInput);
            for (let i = 0; i < lists.length; i++) {
                if (lists[i].childNodes[0].childNodes[0].childNodes[1].innerHTML.toUpperCase().indexOf(searchInput.toUpperCase()) == -1) { lists[i].style.display = 'none'; }
                else { lists[i].style.display = 'block'; a = a + 1; }
            }
            if (a == 0) {
                let notFind = document.getElementsByClassName("notFind")[0];
                notFind.style.display = 'block';
                notFind.innerHTML = '未找到 "' + searchInput + '"';
            }
            else { document.getElementsByClassName("notFind")[0].style.display = 'none'; }
        }
    </script>
</body>
</html>
